CREATE TABLE City_tl (
	City_Code INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	City_Name VARCHAR(100),
	PRIMARY KEY(City_Code)
);

CREATE TABLE Country_tl (
	Country_Code INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	Country_Name VARCHAR(100),
	PRIMARY KEY(Country_Code)
);

CREATE TABLE Branch_tl (
	Branch_Code INT NOT NULL,
	City_Code INT NOT NULL,
	Country_Code INT NOT NULL,
	Branch_Name VARCHAR(100) NOT NULL,
	PRIMARY KEY(Branch_Code),
	FOREIGN KEY (City_Code) REFERENCES City_tl (City_Code),
	FOREIGN KEY (Country_Code) REFERENCES Country_tl (Country_Code)
);

CREATE TABLE Customer_tl (
	Customer_Id INT NOT NULL,
	Branch_Id INT NOT NULL,
	Customer_Name VARCHAR(100) NOT NULL,
	Customer_CNIC VARCHAR(15) NOT NULL,
	PRIMARY KEY(Customer_Id, Branch_Id),
	FOREIGN KEY (Branch_Id) REFERENCES Branch_tl (Branch_Code)
);

CREATE TABLE User_tl (
	User_Id VARCHAR(50) NOT NULL,
	Branch_Id INT NOT NULL,
	Status CHAR(1) NOT NULL,
	IP_Address VARCHAR(20),
	Last_Sign_On TIMESTAMP,
	Password VARCHAR(100) NOT NULL,
	PRIMARY KEY(User_Id),
	FOREIGN KEY (Branch_Id) REFERENCES Branch_tl (Branch_Code)
);

CREATE TABLE Batch_tl (
	Batch_Id INT NOT NULL,
	User_Id VARCHAR(50) NOT NULL,
	Date_And_Time TIMESTAMP NOT NULL,
	CLose_Date_And_Time TIMESTAMP NOT NULL,
	PRIMARY KEY(Batch_Id),
	FOREIGN KEY (User_Id) REFERENCES User_tl (User_Id)
);

CREATE TABLE Condition_tl (
	Condition_Code INT NOT NULL,
	Condition_Name VARCHAR(100),
	Condition_Desc VARCHAR(100),
	PRIMARY KEY(Condition_Code)
);

CREATE TABLE Account_tl (
	Branch_Code INT NOT NULL,
	Account_Type INT NOT NULL,
	Customer_No INT NOT NULL,
	Run_No INT NOT NULL,
	Check_Digit INT NOT NULL,
	Account_No VARCHAR(17) NOT NULL,
	Account_Title VARCHAR(100) NOT NULL,
	Category VARCHAR(100),
	Account_Balance DOUBLE NOT NULL,
	PRIMARY KEY(Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No),
	FOREIGN KEY (Customer_No, Branch_Code) REFERENCES Customer_tl (Customer_Id, Branch_Id)
);

//TO-DO

CREATE TABLE Acc_Cond_tl (
	Branch_Code INT NOT NULL,
	Account_Type INT NOT NULL,
	Customer_No INT NOT NULL,
	Run_No INT NOT NULL,
	Check_Digit INT NOT NULL,
	Account_No VARCHAR(17) NOT NULL,
	Condition_Code INT NOT NULL,
	Remarks VARCHAR(100),
	PRIMARY KEY(Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No, Condition_Code),
	FOREIGN KEY (Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No) REFERENCES Account_tl (Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No),
	FOREIGN KEY (Condition_Code) REFERENCES Condition_tl (Condition_Code)
);

CREATE TABLE Acc_Cond_ht (
	Branch_Code INT NOT NULL,
	Account_Type INT NOT NULL,
	Customer_No INT NOT NULL,
	Run_No INT NOT NULL,
	Check_Digit INT NOT NULL,
	Account_No VARCHAR(17) NOT NULL,
	Condition_Code INT NOT NULL,
	User_Id VARCHAR(50) NOT NULL,
	Remarks VARCHAR(100),
	Date_And_Time TIMESTAMP NOT NULL,
	File_Of_Accounts VARCHAR(100),
	Error_Log VARCHAR(100),
	PRIMARY KEY(Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No, Condition_Code),
	FOREIGN KEY (Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No) REFERENCES Account_tl (Branch_Code, Account_Type, Customer_No, Run_No, Check_Digit, Account_No),
	FOREIGN KEY (Condition_Code) REFERENCES Condition_tl (Condition_Code),
	FOREIGN KEY (User_Id) REFERENCES User_tl (User_Id)
);

